<html>
    <head>
    </head>
    <body>
        <canvas style="border: 1px solid black;" id="canvas" height="640" width="480"></canvas>
        <script src="../build/vendor.js"></script>
        <script src="../build/datadoo.js"></script>
        <script type="text/javascript">
            var dd = new DataDoo({
                canvas: document.getElementById("canvas"),
                camera: {
                    type: DataDoo.PERSPECTIVE
                }
            });

            var ds1 = new DataDoo.DataSet(dd, "ds1",{
                importer : Miso.Dataset.Importers.GoogleSpreadsheet,
                parser : Miso.Dataset.Parsers.GoogleSpreadsheet,
                key : "0ArX_nhRDAroJdFM3aEdDWkJKdDBja1k1UHh3WnFqRlE",
                worksheet : "1",
                sync:true,
                interval : 1000
            });

            var ds2 = new DataDoo.DataSet(dd, "ds2", {
                data: [
                    { one : 10, two : -10, three : 10 },
                    { one : 20, two : -20, three : 20 },
                    { one : 30, two : -30, three : 30 },
                    { one : 40, two : -40, three : 40 }
                ]
            })

            var nodeAppFn1 = function($) {
                var sphere = this.addSphere(10, 0xffcc00);

                sphere.center.x = this.data.Population;
                sphere.center.y = this.data.Population;
                sphere.center.z = this.data.Population;
            };

            var nodeAppFn2 = function($) {
                var sphere = this.addSphere(10, 0xfc12340);

                sphere.center.x = this.data.one;
                sphere.center.y = this.data.two;
                sphere.center.z = this.data.three;

                var sphere2 = this.addSphere(5, 0x11cc88);
                sphere2.center = new DataDoo.RelativePosition(sphere.center, -20, -20, -20);

                var line = this.addDashedLine(new DataDoo.RelativePosition(sphere.center),
                                              new DataDoo.RelativePosition(sphere2.center));
            };

            var relnAppFn = function(ngArr){
                var l = ngArr.length;
                var color = [0xeaeaea, 0xcd762e];
                for(var x =0; x<l-1; x++){
                    var ng = ngArr[x].nodes;
                    var ngNext = ngArr[x+1].nodes;

                    for(var y=0; y<ng.length; y++){
                        for(var z=0;z<ngNext.length; z++){
                            this.addDashedLine(color[x],4,2, ng[y], ngNext[z]);
                            console.log("adding dashed line relations")
                        }

                    }
                }

            };

            var ng1 = new DataDoo.NodeGenerator(dd, "ng1", ds1, nodeAppFn1);
            var ng2 = new DataDoo.NodeGenerator(dd, "ng2", ds2, nodeAppFn2);

            //var rg1 = new DataDoo.RelationGenerator(dd, "rg1", [ng1, ng2], relnAppFn);
            ds1.fetch();
            ds2.fetch();
            dd.startVis(ng1,ng2);
        </script>
    </body>
</html>

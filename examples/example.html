<html>
    <head>
        <style>
            body {
                background:#fff;
                padding:0;
                margin:0;
                overflow:hidden;
                font-family:georgia;
                text-align:center;
            }

            .datadoo-label{
                background: rgba(220,220,220,0.5);
            }

            .datadoo-wrap{

            }
        </style>
    </head>
    <body>
        <canvas id="canvas"></canvas>

        <script src="../build/vendor.js"></script>
        <!--<script src="http://mrdoob.github.com/three.js/examples/fonts/helvetiker_regular.typeface.js"></script>-->
        <script src="../build/datadoo.js"></script>
        <script type="text/javascript">
            var dd = new DataDoo({
                canvas: document.getElementById("canvas"),
                camera: {
                    type: DataDoo.PERSPECTIVE
                },
                axes: {
                    x: {
                        type: DataDoo.COLUMNVALUE,
                        column : "ds1.one",
                        spacing : 30,
                        label : "countries",
                        length : 25,
                        withCone : false,
                        thickness : 0.3
                    },

                    y: {
                        type: DataDoo.NUMBER,
                        label : "hahaha",
                        length : 125,
                        withCone : true,
                        thickness : 0.3
                    },

                    z: {
                        type: DataDoo.NUMBER,
                        label : "vever",
                        length : 125,
                        withCone : false,
                        thickness : 0.3
                    }
                }
            });

            var ds1 = new DataDoo.DataSet(dd, "ds1", {
                data: [
                    { one : "India", two : 10, three : 10 },
                    { one : "Germany", two : 20, three :20 },
                    { one : "Japan", two : 30, three : 30 },
                    { one : "Sweden", two : 40, three : 40 }
                ]
            });

            var ds2 = new DataDoo.DataSet(dd, "ds2",{
                importer : Miso.Dataset.Importers.GoogleSpreadsheet,
                parser : Miso.Dataset.Parsers.GoogleSpreadsheet,
                key : "0ArX_nhRDAroJdFM3aEdDWkJKdDBja1k1UHh3WnFqRlE",
                worksheet : "1",
                sync:true,
                interval : 1000
            });

            var nodeAppFn1 = function($) {
                //var sprite = this.addSprite("http://upload.wikimedia.org/wikipedia/commons/1/1b/Sunny_Leone_2012.jpg", new DataDoo.Position(this.data.Population,this.data.Population,this.data.Population), 10);

                this.sphere = this.addSphere(5, 0xffcc00, 0.3);
                this.sphere.position.set(this.data.two*2.5,this.data.two*2.5,this.data.two*2.5);

                this.cone = this.addCone(10,10,10, "0xe7676e", 0.7);
                this.cone.position.set(-this.data.two*5,this.data.two*5,this.data.two*5);
                //this.cone.rotation.set(this.data.two,this.data.two,this.data.two);
                this.addLine(this.cone, this.sphere);

                this.label = this.addLabel(this.data.one);
                this.label.position.set(this.data.two - 90,this.data.two + 30,this.data.two + 60);
                //this.label.rotation.set(this.data.two - 90,this.data.two + 30,this.data.two + 60);
                //this.label.position.set(20,20,20);

                this.addDashedLine(this.sphere, this.label);
                this.position.set(this.data.two,this.data.two,this.data.two);

            };

            var nodeAppFn2 = function($) {
                console.log(this.data);

                var sphere2 = this.addSphere(this.data.Population/10, 0x767676, 0.5);
                this.position.set(this.data.GDP*10, this.data.GDP, this.data.GDP);
            };

            var relAppFn = function($) {
                var n1 = $.ng1[$.ng1.length-1];
                var n2 = $.ng2[$.ng2.length-1];

                var ns = [];
                _.each($.ng1, function(n){
                    ns.push(n.sphere.position);
                })

                if(n1 && n2) {
                    var r = this.addRelation();
                    r.addDashedLine(n1, n2, 0xff0000);
                }
            };


            var ng1 = new DataDoo.NodeGenerator(dd, "ng1", ds1, nodeAppFn1);
            var ng2 = new DataDoo.NodeGenerator(dd, "ng2", ds2, nodeAppFn2);


            var rg1 = new DataDoo.RelationGenerator(dd, "rg1", [ng1, ng2], relAppFn);
            ds1.fetch();
            ds2.fetch();

            dd.startVis(rg1);
        </script>
    </body>
</html>
